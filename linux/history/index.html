<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>History入门 | bits-pieces</title><link rel=icon href=/bits-pieces/favicon/favicon-32x32.png type=image/x-icon><link rel=stylesheet href=/bits-pieces/main.min.css media=screen><link rel=stylesheet href=/bits-pieces/custom.css media=screen></head><body><div class=wrapper><input type=checkbox class=hidden id=menu-control><header class=gdoc-header><div class="container flex align-center justify-between"><label for=menu-control class=gdoc-nav__control><svg class="icon menu"><use xlink:href="#menu"/></svg><svg class="icon arrow-back"><use xlink:href="#arrow_back"/></svg></label><a class=gdoc-header__link href=https://l10178.github.io/bits-pieces/><span class="gdoc-brand flex align-center"><img class=gdoc-brand__img src=/bits-pieces/images/logos/logo.png alt=bits-pieces width=38 height=38>
bits-pieces</span></a></div></header><main class="container flex flex-even"><aside class=gdoc-nav><nav><div class=gdoc-search><svg class="icon search"><use xlink:href="#search"/></svg><input type=text id=gdoc-search-input class=gdoc-search__input placeholder=Search... aria-label=Search maxlength=64><div class="gdoc-search__spinner spinner hidden"></div><ul id=gdoc-search-results class=gdoc-search__list></ul></div><section class=gdoc-nav--main><h2>Navigation</h2><ul class=gdoc-nav__list><li><span class=flex><a href=/bits-pieces/devops/ class=gdoc-nav__entry>DevOps</a></span><ul class=gdoc-nav__list><li><span class=flex><a href=/bits-pieces/devops/mysql5.7to8.0/ class=gdoc-nav__entry>MySQL5.7升级至8.0</a></span></li><li><span class=flex><a href=/bits-pieces/devops/mysql-large-import/ class=gdoc-nav__entry>MySQL大文件导入优化</a></span></li><li><span class=flex><a href=/bits-pieces/devops/nexus/ class=gdoc-nav__entry>Nexus3 批量导入</a></span></li><li><span class=flex><a href=/bits-pieces/devops/superset/ class=gdoc-nav__entry>Superset 对接 ClickHouse</a></span></li><li><span class=flex><a href=/bits-pieces/devops/cdr/ class=gdoc-nav__entry>使用Visual Studio Code搭建多用户远程IDE</a></span></li></ul></li><li><span class=flex>Javas</span><ul class=gdoc-nav__list><li><span class=flex><a href=/bits-pieces/java/jvm/ class=gdoc-nav__entry>Java进程内存分析</a></span></li><li><span class=flex><a href=/bits-pieces/java/spring-start-site/ class=gdoc-nav__entry>Spring Start脚手架快速入门</a></span></li><li><span class=flex><a href=/bits-pieces/java/spring/ class=gdoc-nav__entry>从Spring到Spring Cloud</a></span></li></ul></li><li><span class=flex>Kubernetes</span><ul class=gdoc-nav__list><li><span class=flex><a href=/bits-pieces/kubernetes/envoy/ class=gdoc-nav__entry>Envoy生产配置最佳实践</a></span></li><li><span class=flex><a href=/bits-pieces/kubernetes/tldr/ class=gdoc-nav__entry>TL;DR</a></span></li><li><span class=flex><a href=/bits-pieces/kubernetes/cka/ class=gdoc-nav__entry>备考 CKA 过程，CKA 真题</a></span></li></ul></li><li><span class=flex><a href=/bits-pieces/linux/ class=gdoc-nav__entry>Linux</a></span><ul class=gdoc-nav__list><li><span class=flex><a href=/bits-pieces/linux/regular-expressions/ class=gdoc-nav__entry>Regular Expressions</a></span></li><li><span class=flex><a href=/bits-pieces/linux/git/ class=gdoc-nav__entry>Git常用配置</a></span></li><li><span class=flex><a href=/bits-pieces/linux/history/ class="gdoc-nav__entry is-active">History入门</a></span></li><li><span class=flex><a href=/bits-pieces/linux/pngquant/ class=gdoc-nav__entry>PNG图片批量压缩</a></span></li><li><span class=flex><a href=/bits-pieces/linux/shell-coding/ class=gdoc-nav__entry>Shell 编程实用句式</a></span></li><li><span class=flex><a href=/bits-pieces/linux/tcpdump/ class=gdoc-nav__entry>tcpdump</a></span></li><li><span class=flex><a href=/bits-pieces/linux/transaction/ class=gdoc-nav__entry>数据库事务控制</a></span></li><li><span class=flex><a href=/bits-pieces/linux/tar.gz/ class=gdoc-nav__entry>文件压缩解压</a></span></li></ul></li><li><span class=flex><a href=/bits-pieces/windows/ class=gdoc-nav__entry>Windows</a></span><ul class=gdoc-nav__list><li><span class=flex><a href=/bits-pieces/windows/takeown/ class=gdoc-nav__entry>Windows提权 + 设置环境变量</a></span></li></ul></li><li><span class=flex><a href=/bits-pieces/knives/ class=gdoc-nav__entry>瑞士军刀</a></span><ul class=gdoc-nav__list><li><span class=flex><a href=/bits-pieces/knives/ripgrep/ class=gdoc-nav__entry>ripgrep</a></span></li><li><span class=flex><a href=/bits-pieces/knives/tldr/ class=gdoc-nav__entry>TL;DR</a></span></li></ul></li></ul></section><section class=gdoc-nav--more><h2>More</h2><ul class=gdoc-nav__list><li><span class=flex><svg class="icon download"><use xlink:href="#download"/></svg><a href=https://github.com/l10178/bits-pieces/releases class=gdoc-nav__entry>Releases</a></span></li><li><span class=flex><svg class="icon github"><use xlink:href="#github"/></svg><a href=https://github.com/l10178/bits-pieces class=gdoc-nav__entry>View Source</a></span></li></ul></section></nav></aside><div class=gdoc-page><div class="gdoc-page__header flex flex-wrap justify-between" itemscope itemtype=https://schema.org/Breadcrumb><span></span><span><svg class="icon code"><use xlink:href="#code"/></svg><a href=https://github.com/l10178/bits-pieces/edit/main/content/linux/history.md>Edit this page</a></span></div><article class=gdoc-markdown><h1>History入门</h1><p>Linux 下 history 命令，用好历史命令提高工作效率。</p><div class=gdoc-page__anchorwrap><h2 id=搜索历史命令>搜索历史命令<a data-clipboard-text=https://l10178.github.io/bits-pieces/linux/history/#搜索历史命令 class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 搜索历史命令" href=#搜索历史命令><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>快捷键 Ctrl + r</p><p>非常建议你使用这个命令, 因为当你曾经输过一个很长的命令之后, 当你再次想输入这个命令的时候, 你就可以按下这个快捷键, 然后键入那条长命令的关键词, 然后就会显示出含有那个关键词的命令, 每次按下这个键都会再往上搜一个。可以找个机器实际体会下，确实很常用。</p><div class=gdoc-page__anchorwrap><h2 id=重复上一次的命令>重复上一次的命令<a data-clipboard-text=https://l10178.github.io/bits-pieces/linux/history/#重复上一次的命令 class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 重复上一次的命令" href=#重复上一次的命令><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>向上的方向键。上下键翻看历史命令，翻到想执行的命令回车。</p><p>两个叹号: ！！</p><p>还有这个：！-1</p><p>快捷键：Ctrl+p 或 Ctrl+n，向上和向下翻看历史命令，和上下键效果一样。</p><p>从历史记录中执行某个命令
还是沿袭上一个中的 !-n 模式, 其中 n 是一个编号。如下示例，执行了编号为 4 的命令。</p><pre><code class=language-console data-lang=console>1 service network restart
2 exit
3 id
4 cat /etc/redhat-release
# !4
cat /etc/redhat-release
</code></pre><div class=gdoc-page__anchorwrap><h2 id=执行曾经的命令中特定开头的>执行曾经的命令中特定开头的<a data-clipboard-text=https://l10178.github.io/bits-pieces/linux/history/#执行曾经的命令中特定开头的 class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 执行曾经的命令中特定开头的" href=#执行曾经的命令中特定开头的><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>假设你的部分历史命令如下:</p><pre><code class=language-console data-lang=console>1721 find . -type f
</code></pre><p>那么, 怎样重复执行 1721 条呢? 除了利用 !-1721 这么麻烦的方法，我们还可以用 !f 这样的姿势。因为开头的 f 是离着最后一条命令最近的, 所以 !f 就执行了它。</p><div class=gdoc-page__anchorwrap><h2 id=清空历史记录>清空历史记录<a data-clipboard-text=https://l10178.github.io/bits-pieces/linux/history/#清空历史记录 class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 清空历史记录" href=#清空历史记录><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><pre><code class=language-console data-lang=console>history -c
</code></pre><div class=gdoc-page__anchorwrap><h2 id=在历史记录中显示时间>在历史记录中显示时间<a data-clipboard-text=https://l10178.github.io/bits-pieces/linux/history/#在历史记录中显示时间 class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 在历史记录中显示时间" href=#在历史记录中显示时间><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>我们可以用 HISTTIMEFORMAT 这个变量来定义显示历史记录时的时间参数:</p><pre><code class=language-console data-lang=console># export HISTTIMEFORMAT='%F %T '
# history
</code></pre><p>也可以用下面的别名来定义显示历史命令的数量:</p><pre><code class=language-console data-lang=console>alias h1='history 10'
</code></pre><div class=gdoc-page__anchorwrap><h2 id=用-histcontrol-来删除重复的历史记录>用 HISTCONTROL 来删除重复的历史记录<a data-clipboard-text=https://l10178.github.io/bits-pieces/linux/history/#用-histcontrol-来删除重复的历史记录 class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 用 HISTCONTROL 来删除重复的历史记录" href=#用-histcontrol-来删除重复的历史记录><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>下面的例子中, 有三个 pwd 命令, 那么在 history 中就会显示三次 pwd , 有点不那么人性化。</p><pre><code class=language-console data-lang=console># pwd
# pwd
# pwd
# history | tail -4
44 pwd
45 pwd
46 pwd
47 history | tail -4
</code></pre><p>所以我们可以这样修改:</p><pre><code class=language-console data-lang=console>export HISTCONTROL=ignoredups
</code></pre><p>然后就不会出现相邻的重复记录了。</p><div class=gdoc-page__anchorwrap><h2 id=history-扩展和总结>History 扩展和总结<a data-clipboard-text=https://l10178.github.io/bits-pieces/linux/history/#history-扩展和总结 class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor History 扩展和总结" href=#history-扩展和总结><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>用这个功能可以选择特定的历史记录, 不论是修改还是立即执行, 都可以完成。</p><p>!! 重复上一条命令。</p><p>!10 重复历史记录中第 10 条命令。</p><p>!-2 重复历史记录中倒数第二条命令。</p><p>!string 重复历史记录中最后一条以 string 开头的命令。</p><p>!?string 重复历史记录中最后一条包含 string 的命令。</p></article><div class="gdoc-page__footer flex flex-wrap justify-between"></div></div></main><footer class=gdoc-footer><div class="container flex flex-wrap"><span class=gdoc-footer__item>Copyright © 2020-2022 <a href=https://www.nxest.com class=gdoc-footer__link>nxest.com</a>.</span></div></footer></div><script defer src=/bits-pieces/js/en.search.min.js></script><script defer src=/bits-pieces/js/clipboard.min.js></script><script>document.addEventListener("DOMContentLoaded",function(event){var clipboard=new ClipboardJS('.clip');});</script></body></html>